const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/authService.D8TLf2yW.js","_astro/preload-helper.BlTxHScW.js"])))=>i.map(i=>d[i]);
import{_ as r}from"./preload-helper.BlTxHScW.js";document.addEventListener("DOMContentLoaded",async()=>{await u()});async function u(){try{const{AuthService:t}=await r(async()=>{const{AuthService:n}=await import("./authService.D8TLf2yW.js");return{AuthService:n}},__vite__mapDeps([0,1])),e=await t.getCurrentUser();e?l(e):d()}catch(t){console.error("Error verificando autenticación:",t),d()}}function l(t){const e=document.getElementById("auth-loading"),n=document.getElementById("login-required"),s=document.getElementById("change-password-content"),a=document.getElementById("admin-info"),o=document.getElementById("change-password-form"),i=document.getElementById("logout-btn");e&&e.classList.add("hidden"),n&&n.classList.add("hidden"),s&&s.classList.remove("hidden"),a&&(a.textContent=`Administrador: ${t.email}`),o&&o.addEventListener("submit",g),i&&i.addEventListener("click",h)}function d(){const t=document.getElementById("auth-loading"),e=document.getElementById("login-required"),n=document.getElementById("change-password-content");t&&t.classList.add("hidden"),n&&n.classList.add("hidden"),e&&(e.classList.remove("hidden"),e.classList.add("flex"))}async function g(t){t.preventDefault();const e=t.target,n=new FormData(e),s=n.get("newPassword"),a=n.get("confirmPassword");if(s!==a){c("Las contraseñas no coinciden");return}if(s.length<6){c("La contraseña debe tener al menos 6 caracteres");return}try{m(!0),w();const{AuthService:o}=await r(async()=>{const{AuthService:i}=await import("./authService.D8TLf2yW.js");return{AuthService:i}},__vite__mapDeps([0,1]));await o.changePassword(s),f("Contraseña cambiada exitosamente"),e.reset()}catch(o){c(o.message||"Error al cambiar contraseña")}finally{m(!1)}}async function h(){try{const{AuthService:t}=await r(async()=>{const{AuthService:e}=await import("./authService.D8TLf2yW.js");return{AuthService:e}},__vite__mapDeps([0,1]));await t.signOut(),window.location.href="/login"}catch(t){console.error("Error al cerrar sesión:",t),window.location.href="/login"}}function c(t){const e=document.getElementById("error-message");e&&(e.textContent=t,e.classList.remove("hidden"))}function f(t){const e=document.getElementById("success-message");e&&(e.classList.remove("hidden"),setTimeout(()=>{e.classList.add("hidden")},5e3))}function w(){const t=document.getElementById("error-message"),e=document.getElementById("success-message");t&&t.classList.add("hidden"),e&&e.classList.add("hidden")}function m(t){const e=document.getElementById("change-btn"),n=document.getElementById("change-text"),s=document.getElementById("change-spinner");t?(e.disabled=!0,n&&(n.textContent="Cambiando..."),s&&s.classList.remove("hidden")):(e.disabled=!1,n&&(n.textContent="Cambiar Contraseña"),s&&s.classList.add("hidden"))}
